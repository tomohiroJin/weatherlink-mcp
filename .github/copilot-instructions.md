### `copilot-rules.md` ― _Weatherlink‑MCP 専用・最小ガイドライン_

> **目的**  
> Copilot の提案を「MCP サーバー開発（Python + FastAPI）に最適化」し、読みやすく安全なコードを保つ。

---

#### 1. 言語・記法

- **実装:** Python 3.11 ／  型注釈必須
- **命名:** 説明的な英語（snake_case）
- **コメント／テスト名／README:** 日本語
- インデント 4  スペース

#### 2. 実装スタイル

| 項目               | ルール                                                                                             |
| ------------------ | -------------------------------------------------------------------------------------------------- |
| **アーキテクチャ** | FastAPI + `mcp-python`。ディレクトリは<br>`app/` _(FastAPI)_・`domain/` _(純粋ロジック)_・`tests/` |
| **関数型志向**     | 可能な限り純粋関数。副作用関数は `_io` 接尾辞で区別                                                |
| **契約(DbC)**      | docstring に<br>‐ 事前条件  `Pre:`<br>‐ 事後条件  `Post:`<br>を記述し、`assert` で検証             |
| **関数長**         | 20 行以下・サイクロマティック複雑度 ≤ 7                                                            |
| **早期 return**    | ネストを浅く保つ                                                                                   |

#### 3. TDD ワークフロー

1. **RED**: pytest で失敗テストを書く
2. **GREEN**: 最小実装で通す
3. **REFACTOR**: 重複削除・命名整理
4. **コミット**: `feat: …`, `refactor: …` 等 Conventional Commits

#### 4. ドキュメント & 自動化

- `README.md` を必ず更新（概要／起動方法／.env 設定）
- CI: `pytest`, `ruff`, `mypy` を GitHub Actions で実行
- `.env*`・キャッシュ・ビルド物は `.gitignore`

#### 5. セキュリティ

- API キーを**絶対に**ハードコードしない
- 外部入力は `pydantic` でバリデーション
- 例外は具体的なメッセージ付きで `HTTPException`

#### 6. 禁止事項

- 未使用インポート／デバッグ `print`
- 無意味なコメントや TODO 放置
- main ブランチへの直接 push

---

**このファイルを遵守して提案してください — Happy coding with Copilot!**
